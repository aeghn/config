* Archlinux install
** connect to internet
   #+begin_src shell
   iwctl --passphrase 密码 station 网卡 connect SSID
   #+end_src
** partition
   #+begin_src shell
   cfdisk /dev/nvme0n0
   mkfs.fat -F 32 /dev/efi_partition
   # 这个 chinslt 会在后面的 boot loader 中用到
   mkfs.btrfs -L chinslt /dev/vda2

   # 注意这个compress，压缩算法可以换成你喜欢的

   mount --mkdir /dev/vda2 -o compress=zstd /tmp/btrfs-full

   # 创建子卷

   btrfs subvol create /tmp/btrfs-full/@

   btrfs subvol create /tmp/btrfs-full/@home

   btrfs subvol create /tmp/btrfs-full/@var-tmp

   btrfs subvol create /tmp/btrfs-full/@var-cache

   # 为部分不需要写时复制的子卷设置相关属性

   chattr +C /tmp/btrfs-full/@var-cache

   umount /tmp/btrfs-full

   mount --mkdir /dev/nvme0n1p2 -o compress=zstd,subvol=@ /mnt
   mount --mkdir /dev/nvme0n1p2 -o subvol=@home /mnt/home
   mount --mkdir /dev/nvme0n1p2 -o subvol=@var-tmp /mnt/var/tmp
   mount --mkdir /dev/nvme0n1p2 -o subvol=@var-cache /mnt/var/cache
   mount --mkdir /dev/nvme0n1p1 /mnt/boot
   #+end_src
** install
   #+begin_src
   pacstrap -K /mnt base linux linux-firmware vim man amd-ucode btrfs-progs networkmanager
   #+end_src
** genfstab
   #+begin_src shell
   genfstab -U /mnt >> /mnt/etc/fstab
   #+end_src
   修改 fstab，去掉其他的默认选项，保持这样
   #+begin_src
   # Static information about the filesystems.
# See fstab(5) for details.

# <file system> <dir> <type> <options> <dump> <pass>
# /dev/nvme0n1p2
UUID=212d5122-3041-41d1-aab5-751a3f168d2d       /               btrfs           rw,relatime,compress=zstd:3,subvol=/@   0 0

# /dev/nvme0n1p2
UUID=212d5122-3041-41d1-aab5-751a3f168d2d       /home           btrfs           rw,relatime,compress=zstd:3,subvol=/@home       0 0

# /dev/nvme0n1p2
UUID=212d5122-3041-41d1-aab5-751a3f168d2d       /var/tmp        btrfs           rw,relatime,compress=zstd:3,subvol=/@var-tmp    0 0

# /dev/nvme0n1p2
UUID=212d5122-3041-41d1-aab5-751a3f168d2d       /var/cache      btrfs           rw,relatime,compress=zstd:3,subvol=/@var-cache  0 0

# /dev/nvme0n1p1
UUID=04C5-39D0          /boot           vfat            rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=ascii,shortname=mixed,utf8,errors=remount-ro   0 2
   #+end_src
** chroot
   #+begin_src shell
   arch-chroot /mnt
   #+end_src
** timezone
   #+begin_src shell
   ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
   hwclock --systohc
   #+end_src
** locale
   #+begin_src
   echo LANG=en_US.UTF-8 > /etc/locale.conf
   #+end_src
** hostname
   #+begin_src shell
   echo chinslt > /etc/hostname
   #+end_src
** Initramfs
   #+begin_src
   mkinitcpio -P
   #+end_src
** Some other packages
   #+begin_src shell
   pacman -S zsh git ripgrep
   #+end_src
** user and passwd
   #+begin_src shell
   passwd
   useradd -m -G wheel -s /bin/zsh chin
   passwd chin
   #+end_src
** boot
   #+begin_src shell
   bootctl install

   mkdir -p /boot/loader/entries
   #+end_src
*** 对于 intel
    #+begin_src shell
    echo -e 'title Arch Linux\nlinux /vmlinuz-linux\ninitrd /initramfs-linux.img\ninitrd /intel-ucode.img\noptions root=LABEL=chinslt rw rootflags=subvol=@ intel_iommu=on iommu=pt' > /boot/loader/entries/arch.conf
    #+end_src
*** 对于 amd
    #+begin_src shell
    echo -e 'title Arch Linux\nlinux /vmlinuz-linux\ninitrd /initramfs-linux.img\ninitrd /amd-ucode.img\noptions root=LABEL=chinslt rw rootflags=subvol=@' > /boot/loader/entries/arch.conf
    #+end_src
*** 启动后
    #+begin_src
    vim /etc/sudoers
    sudo pacman -S --needed openssh rustup firefox niri foot emacs 7zip adw-gtk-theme android-tools aria2 ascii b3sum baobab base base-devel bash-completion bc bind biome bluetui bottom brightnessctl btop btrfs-progs chafa chromium chrpath clash cliphist cmake deskflow dialog difftastic dmidecode dnsmasq dotnet-runtime-7.0 epiphany ethtool fcitx5 fcitx5-configtool fcitx5-gtk fcitx5-qt fcitx5-rime fd firefox foot fuse-overlayfs fzf gcc-fortran gdu git git-filter-repo git-lfs gitlogue graphviz grilo-plugins grim gthumb gtk-layer-shell gtk4 gtk4-layer-shell gvfs-afc gvfs-dnssd gvfs-goa gvfs-google gvfs-gphoto2 gvfs-mtp gvfs-nfs gvfs-onedrive gvfs-smb gvfs-wsdd haveged htop hwloc imagemagick imv inetutils inkscape inotify-tools iptables-nft iw jp2a jq keepassxc kvantum lan-mouse libbsd linux loupe lsof mako malcontent man-db marker maven meld meson mimalloc  mold monolith mpv nemo net-tools networkmanager niri nm-connection-editor nodejs-lts-krypton npm ntfs-3g ntp nvtop nwg-look obs-studio oha onefetch onetbb openssh oryx papirus-icon-theme pass passt pavucontrol perf  pipewire-alsa pipewire-docs pipewire-pulse pnpm podman podman-compose podman-docker polkit-gnome postgresql-libs pragha proxychains-ng qt5-wayland qt6ct ripgrep rpmextract rsync rustup rygel samply sccache serie shfmt simple-scan skim slirp4netns slumber slurp smartmontools snapshot socat solanum sshfs strace swaybg swayidle swaylock swww tecla television tlp tmux  tree ttf-ibm-plex ttf-martian-mono-nerd ttf-roboto-mono typst unzip uutils-coreutils uv vim visidata w3m wezterm wget wireless_tools wireplumber wireshark-qt wl-clipboard wpaperd xdg-desktop-portal-gtk xed xorg-xwayland xplr xwayland-satellite yamlfmt yarn yelp zed zip zsh 
    #+end_src
    #+begin_src
    sudo pacman -S xdg-user-dirs
    LC_ALL=C.UTF-8 xdg-user-dirs-update --force
    #+end_src
