#!/usr/bin/env bash

set -eu

# Created by dfs

######### TDOC_BEGIN
# is_linux: check if linux
# is_msys: check if msys2
# msg: msg
# warn: warn
# die: die
# ask: ask for prompt, and return the value
# git_managed: check if current dir is in git managed
# git_is_dirty: check if current git repo is dirty
# kln: ln -sT $1 $2
# kcp: cp -rT $1 $2
# kmap: try to map by using kcp or kln
# DFS_DIR
######## TDOC_END

# File to store and restore.

store() {
    warn "store not implement, $PWD"
}

restore() {
    if is_msys; then
        restore_msys2
    else
        restore_nix
    fi
}

restore_nix() {
    cat <<EOF > $HOME/.zshrc
export CHIN_PG_DIR="$HOME/playground"
export CHIN_FILES_DIR="$HOME/files"
source "$DFS_DIR/init.zsh"
source "$DFS_DIR/tools.zsh"
source "$DFS_DIR/nix.zsh"
EOF
}

restore_msys2() {
    cat <<EOF
export CHIN_PG_DIR="/f/playground-data"
export CHIN_FILES_DIR="/d/files"
source "$DFS_DIR/init.zsh"
source "$DFS_DIR/tools.zsh"
source "$DFS_DIR/msys2.zsh"
EOF
}
